{
    "contents" : "#--------Functions--------\nOnStartUp = function ()\n{\n  # Load packages\n  packs = c(\"magrittr\", \"dplyr\", \"ggplot2\", \"lubridate\", \"ggplot2\", \"ggthemes\", \"reshape2\", \"gridExtra\")\n  sapply(packs, require, character.only=TRUE)   # Load the packages.\n}\n\nReadHoursCSV = function () \n{\n  # Load data\n  path = \"~/Google Drive/100 - Publicly hosted/Austin Pets Alive/database/APA_volunteer_explore/hours.csv\"\n  hours.orig = read.csv(path, na.strings=\"\") %>%\n    select(-starts_with(\"Create\"),\n           -DatabaseTimelogEntryId, -DateEntered, -DateUpdated, -EntryType, \n           -DatabaseActivityReportGroupId, -ClockStartDate, -ClockEndDate)\n  \n  # Set factors\n  hours.orig$DatabaseActivityCategoryId <- as.factor(hours.orig$DatabaseActivityCategoryId)\n  hours.orig$DatabaseActivityId         <- as.factor(hours.orig$DatabaseActivityId)\n  hours.orig$DatabaseUserId             <- as.factor(hours.orig$DatabaseUserId)\n  hours.orig <- mutate(hours.orig, DateVolunteered = mdy_hms(DateVolunteered)) %>%\n    filter(DateVolunteered > ymd(\"2013-12-31\"), DateVolunteered < ymd(\"2015-10-05\"), \n           ActivityCategoryName != \"APA! Staff\", ActivityCategoryName != \"New Volunteers\")\n  \n  # Return CSV as data frame\n  hours.orig\n}\n\nGetHoursClock = function (df)\n{\n  # Accepts a data frame from before\n  df = filter(df, !is.na(ClockStartTime)) %>%\n    mutate(\n      ClockStartTime = paste(DateVolunteered, ClockStartTime),\n      ClockEndTime   = paste(DateVolunteered, ClockEndTime)\n    ) %>%\n    mutate(\n      ClockStartTime = ymd_hm(ClockStartTime),\n      ClockEndTime   = ymd_hm(ClockEndTime)\n    )\n  \n  # Make column measuring minutes\n  df$MinutesWorked = df$HoursWorked * 60\n  \n  # Return df\n  df\n}\n# - - -END Functions - - - -\n\n#--------Load data--------\nOnStartUp()\nhours.import = ReadHoursCSV()\nhours.clock  = GetHoursClock(hours.import)\nhours        = filter(hours.import, is.na(ClockStartTime)) %>%  select(-ClockStartTime, -ClockEndTime) \nrm(hours.import)\n\n#--------Define plots--------\n# levels(hours.clock$ActivityCategoryName)\ndogs   = c(\"Dog Program - Behavior\", \"Dog Program - Big Brother/Big Sister\", \"Dog Program - TLAC\", \"Dog Program - Marketing\")\ncats   = c(\"Specialty - Neonatal (BB)\", \"Cat Program - TLAC\", \"Cat Program - Support\", \"Cat Program - Marketing\")\nothers = c(\"Behind the Scenes\", \"Community Service Restitution\", \"General, Administrative & Facilities\", \"Specialty - Clinic\")\n\n\n\nP1 = filter(hours.clock, ActivityCategoryName %in% dogs, MinutesWorked < 960) %>%\n  mutate(DayOfWeek = wday(DateVolunteered, label = TRUE)) %>%\n  ggplot(aes(x=DayOfWeek, y=MinutesWorked)) + \n  ggtitle(\"Dog Volunteers\")\n\nP2 = filter(hours.clock, ActivityCategoryName %in% cats, MinutesWorked < 960) %>%\n  mutate(DayOfWeek = wday(DateVolunteered, label = TRUE)) %>%\n  ggplot(aes(x=DayOfWeek, y=MinutesWorked)) + \n  ggtitle(\"Cat Volunteers\")\n\nP3 = filter(hours.clock, ActivityCategoryName %in% others, MinutesWorked < 960) %>%\n  mutate(DayOfWeek = wday(DateVolunteered, label = TRUE)) %>%\n  ggplot(aes(x=DayOfWeek, y=MinutesWorked)) + \n  ggtitle(\"General Volunteers\")\n\nview1 = geom_boxplot(aes(fill=DayOfWeek)) \nview2 = geom_boxplot(aes(fill=factor(ActivityCategoryName)))\nother_args = labs(x=\"Day of week\", y=\"Time volunteered (minutes)\") + theme_fivethirtyeight()\n\nG1 = P1 + view1 + scale_y_continuous(breaks=c((1:10)*60), lim = c(0, 600)) + guides(fill=FALSE) + other_args + theme_fivethirtyeight()\nG2 = P2 + view1 + scale_y_continuous(breaks=c((1:10)*60), lim = c(0, 600)) + guides(fill=FALSE) + other_args + theme_fivethirtyeight()\nG3 = P3 + view1 + scale_y_continuous(breaks=c((1:10)*60), lim = c(0, 600)) + guides(fill=FALSE) + other_args + theme_fivethirtyeight()\n\nG4 = P1 + view2 + scale_y_continuous(breaks=c((1:10)*60), lim = c(0, 600)) + other_args + theme_fivethirtyeight()\nG5 = P2 + view2 + scale_y_continuous(breaks=c((1:10)*60), lim = c(0, 600)) + other_args + theme_fivethirtyeight()\nG6 = P3 + view2 + scale_y_continuous(breaks=c((1:10)*60), lim = c(0, 600)) + other_args + theme_fivethirtyeight()\n  \n#--------Make results--------\npdf(\"By_day_of_week.pdf\", width = 11, height = 7)\ngrid.arrange(G1, G2, G3, ncol=3)\ngrid.arrange(G1, G4, nrow=2)\ngrid.arrange(G2, G5, nrow=2)\ngrid.arrange(G3, G6, nrow=2)\ndev.off()             \n\npdf(\"By_day_of_week.pdf-Details.pdf\", width = 12, height = 12)\ngrid.arrange(G4, G5, G6, nrow=3)\ndev.off()             \n\n\npdf(\"By_day_of_week.pdf-Huge.pdf\", width = 24, height = 12)\ngrid.arrange(G1, G2, G3,\n             G4, G5, G6, ncol=3)\ndev.off()             \n\n\n# facet_wrap(\"ActivityCategoryName\") \n",
    "created" : 1444110792976.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "2|1|6|0|\n",
    "hash" : "3989430039",
    "id" : "63F4024D",
    "lastKnownWriteTime" : 1444110544,
    "path" : "~/Google Drive/100 - Publicly hosted/Austin Pets Alive/database/APA_volunteer_explore/By_day_of_week/By day of week.R",
    "project_path" : "By day of week.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}